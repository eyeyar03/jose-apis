https://connect2id.com/products/nimbus-jose-jwt/examples/validating-jwt-access-tokens
https://connect2id.com/products/nimbus-jose-jwt/examples/signed-and-encrypted-jwt
https://info.townsendsecurity.com/rsa-vs-aes-encryption-a-primer
https://stackoverflow.com/questions/20233775/how-to-generate-secret-key-in-java-once-and-use-that-key-in-2-different-programs

SENDER:
RSAKey senderJWK = new RSAKeyGenerator(2048)
    .keyID("123")
    .keyUse(KeyUse.SIGNATURE)
    .generate();
RSAKey senderPublicJWK = senderJWK.toPublicJWK();

RECIPIENT:
RSAKey recipientJWK = new RSAKeyGenerator(2048)
    .keyID("456")
    .keyUse(KeyUse.ENCRYPTION)
    .generate();
RSAKey recipientPublicJWK = recipientJWK.toPublicJWK();


eyJraWQiOiIxMjMiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIxMjM0NSIsImlzcyI6Imh0dHBzOlwvXC9wZXRjaXJjbGUuY29tLmF1XC9hdXRoIiwiZXhwIjoxNTgwMzk4MDk2LCJpYXQiOjE1ODAzOTc0OTZ9.IQ9_fRhKV9OhboDYh1PPqxbjsW3reNS48j1SOAqzLqSvEav84B9n0QihsaBHkdMt6uHaGI2wWcVXB7xoHGu0SIYWXMtqpjyuVbZDm9JAgz05U_j3GWMSaTncThse1c0xt_SI5S8sHDdBDzlpjMQ6UuSvS8ZaI5nKt6OhK6yoRmkvYbIEezTEgzB1RwuTx-WwJ56bzieSHPyIk4yPR4790-B5tnLPFokaoPL28j25NcVdN6Xh0Tx0ZN6GACV1uL-3R1mUtPdJjuUdTYV4moXP9YRlZaXyYkdURD89LeHp-9PIF1N9KzBk3l6QuR46DGipmdPbtGEfQI-EKMY96auynw

eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAtMjU2In0.KKAR3d2xK3057cjSUit1Kidwj8t4CmlwV7mZNCYXDdTI95feH-wAjUQXwmjA4UMcbNJe6SQ4efyqsd5iRCP_Vc38ycaFwQBNUa5-966nsZxpRrIPZTRmQAGeYLYkvfrXTz3_T68OPicl0fi-CgdAi73krOpYsKBr7XNV3WNQnxAT0vtDFGTp47qZMIdILhCZcouZZXgd3n09_oEo8Mht6L_WZnLMSLQIS3JnEFei50HHlyLsIU3k8HknvYYb62WclNQptdfqdazaSX7nemdpQtg66OBkFpF7siwgJ6cniq8mN4YD1cLMK5KEbwa5BBtS3iwqxoX3vSKgKL56Oy_Q3Q.49AHLqenFWN6Jii0.Y5XhgHhFtpY21Thx5-s-d4At6WqhUg-1B6B3Zz40tG8s8QUu7Vf1R9LXDCThb_pyzquNsxmbcsQMj2dK6PvNC0bJDS-gt7eOD3QzvI0f6D8vG0op56IhXRjrrHG6G3QWS2CDlZvvDlCs8Y3yN5Pv9jieWPrVGn2TyUurHr4j56H1PTuEh9RnzXcHNGne9oK4nELrE4uIpqE1vcekfL69b7cdJzbPfqFf62KemotzRAnSjn-eE_3CTF6PtDkgMyt8R0Aa2tU-oeXDZZkV64QqPT9ldOjbIv5lL4CtULLs6hbduYjO9TAnCoFPIYfbcGJ_FJ1cO6zFhqDExseMRZEOhITZp2i9xe8Fg9yA5GAH99LvxVZa18dm4lz1s7Ys4_AOn58jhO1jzo5FnjNGxO3jD3ZYrbN3tphs6cWozh0_Z7VW_jUiKx_8xRTLw8KpMhShE7L15ZNlTURvZq3e-BRUJji6a7e-fLGitEl04jSkop8DbjJFRayElF6c5AviRHMFV_fbEOmN3gmXFGsz5Fxl5q7Q7gAybDzMi3VZsm66v4t4invajw_dL5j3LmqAgls4h68UliqAmCm77dWFUmUF5q8bo22WLWOXtO1PN8w2pFfk3AVsNWMYDha1Nyc57bgn9Y3QSARsOEGhWrIpePOGHWgZsWwet6irrTdu4L0rLXPJ6zsk.Atc07-RDAPWDm216RxGpZg

eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAtMjU2In0.KKAR3d2xK3057cjSUit1Kidwj8t4CmlwV7mZNCYXDdTI95feH-wAjUQXwmjA4UMcbNJe6SQ4efyqsd5iRCP_Vc38ycaFwQBNUa5-966nsZxpRrIPZTRmQAGeYLYkvfrXTz3_T68OPicl0fi-CgdAi73krOpYsKBr7XNV3WNQnxAT0vtDFGTp47qZMIdILhCZcouZZXgd3n09_oEo8Mht6L_WZnLMSLQIS3JnEFei50HHlyLsIU3k8HknvYYb62WclNQptdfqdazaSX7nemdpQtg66OBkFpF7siwgJ6cniq8mN4YD1cLMK5KEbwa5BBtS3iwqxoX3vSKgKL56Oy_Q3Q.49AHLqenFWN6Jii0.Y5XhgHhFtpY21Thx5-s-d4At6WqhUg-1B6B3Zz40tG8s8QUu7Vf1R9LXDCThb_pyzquNsxmbcsQMj2dK6PvNC0bJDS-gt7eOD3QzvI0f6D8vG0op56IhXRjrrHG6G3QWS2CDlZvvDlCs8Y3yN5Pv9jieWPrVGn2TyUurHr4j56H1PTuEh9RnzXcHNGne9oK4nELrE4uIpqE1vcekfL69b7cdJzbPfqFf62KemotzRAnSjn-eE_3CTF6PtDkgMyt8R0Aa2tU-oeXDZZkV64QqPT9ldOjbIv5lL4CtULLs6hbduYjO9TAnCoFPIYfbcGJ_FJ1cO6zFhqDExseMRZEOhITZp2i9xe8Fg9yA5GAH99LvxVZa18dm4lz1s7Ys4_AOn58jhO1jzo5FnjNGxO3jD3ZYrbN3tphs6cWozh0_Z7VW_jUiKx_8xRTLw8KpMhShE7L15ZNlTURvZq3e-BRUJji6a7e-fLGitEl04jSkop8DbjJFRayElF6c5AviRHMFV_fbEOmN3gmXFGsz5Fxl5q7Q7gAybDzMi3VZsm66v4t4invajw_dL5j3LmqAgls4h68UliqAmCm77dWFUmUF5q8bo22WLWOXtO1PN8w2pFfk3AVsNWMYDha1Nyc57bgn9Y3QSARsOEGhWrIpePOGHWgZsWwet6irrTdu4L0rLXPJ6zsk.Atc07-RDAPWDm216RxGpZg

eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAtMjU2In0.KKAR3d2xK3057cjSUit1Kidwj8t4CmlwV7mZNCYXDdTI95feH-wAjUQXwmjA4UMcbNJe6SQ4efyqsd5iRCP_Vc38ycaFwQBNUa5-966nsZxpRrIPZTRmQAGeYLYkvfrXTz3_T68OPicl0fi-CgdAi73krOpYsKBr7XNV3WNQnxAT0vtDFGTp47qZMIdILhCZcouZZXgd3n09_oEo8Mht6L_WZnLMSLQIS3JnEFei50HHlyLsIU3k8HknvYYb62WclNQptdfqdazaSX7nemdpQtg66OBkFpF7siwgJ6cniq8mN4YD1cLMK5KEbwa5BBtS3iwqxoX3vSKgKL56Oy_Q3Q.49AHLqenFWN6Jii0.Y5XhgHhFtpY21Thx5-s-d4At6WqhUg-1B6B3Zz40tG8s8QUu7Vf1R9LXDCThb_pyzquNsxmbcsQMj2dK6PvNC0bJDS-gt7eOD3QzvI0f6D8vG0op56IhXRjrrHG6G3QWS2CDlZvvDlCs8Y3yN5Pv9jieWPrVGn2TyUurHr4j56H1PTuEh9RnzXcHNGne9oK4nELrE4uIpqE1vcekfL69b7cdJzbPfqFf62KemotzRAnSjn-eE_3CTF6PtDkgMyt8R0Aa2tU-oeXDZZkV64QqPT9ldOjbIv5lL4CtULLs6hbduYjO9TAnCoFPIYfbcGJ_FJ1cO6zFhqDExseMRZEOhITZp2i9xe8Fg9yA5GAH99LvxVZa18dm4lz1s7Ys4_AOn58jhO1jzo5FnjNGxO3jD3ZYrbN3tphs6cWozh0_Z7VW_jUiKx_8xRTLw8KpMhShE7L15ZNlTURvZq3e-BRUJji6a7e-fLGitEl04jSkop8DbjJFRayElF6c5AviRHMFV_fbEOmN3gmXFGsz5Fxl5q7Q7gAybDzMi3VZsm66v4t4invajw_dL5j3LmqAgls4h68UliqAmCm77dWFUmUF5q8bo22WLWOXtO1PN8w2pFfk3AVsNWMYDha1Nyc57bgn9Y3QSARsOEGhWrIpePOGHWgZsWwet6irrTdu4L0rLXPJ6zsk.Atc07-RDAPWDm216RxGpZg

eyJraWQiOiIxMjMiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIxMjM0NSIsImlzcyI6Imh0dHBzOlwvXC9wZXRjaXJjbGUuY29tLmF1XC9hdXRoIiwiZXhwIjoxNTgwMzk4MDk2LCJpYXQiOjE1ODAzOTc0OTZ9.IQ9_fRhKV9OhboDYh1PPqxbjsW3reNS48j1SOAqzLqSvEav84B9n0QihsaBHkdMt6uHaGI2wWcVXB7xoHGu0SIYWXMtqpjyuVbZDm9JAgz05U_j3GWMSaTncThse1c0xt_SI5S8sHDdBDzlpjMQ6UuSvS8ZaI5nKt6OhK6yoRmkvYbIEezTEgzB1RwuTx-WwJ56bzieSHPyIk4yPR4790-B5tnLPFokaoPL28j25NcVdN6Xh0Tx0ZN6GACV1uL-3R1mUtPdJjuUdTYV4moXP9YRlZaXyYkdURD89LeHp-9PIF1N9KzBk3l6QuR46DGipmdPbtGEfQI-EKMY96auynw


om.nimbusds.jose.JOSEException: Decryption error

	at com.nimbusds.jose.crypto.impl.RSA_OAEP_256.decryptCEK(RSA_OAEP_256.java:123)
	at com.nimbusds.jose.crypto.RSADecrypter.decrypt(RSADecrypter.java:278)
	at com.nimbusds.jose.JWEObject.decrypt(JWEObject.java:415)
	at NimusRsaTest.testExpiredToken(NimusRsaTest.java:121)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:68)
	at com.intellij.rt.execution.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:47)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:242)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:70)
Caused by: javax.crypto.BadPaddingException: Decryption error
	at sun.security.rsa.RSAPadding.unpadOAEP(RSAPadding.java:502)
	at sun.security.rsa.RSAPadding.unpad(RSAPadding.java:296)
	at com.sun.crypto.provider.RSACipher.doFinal(RSACipher.java:363)
	at com.sun.crypto.provider.RSACipher.engineDoFinal(RSACipher.java:389)
	at javax.crypto.Cipher.doFinal(Cipher.java:2164)
	at com.nimbusds.jose.crypto.impl.RSA_OAEP_256.decryptCEK(RSA_OAEP_256.java:115)
	... 25 more